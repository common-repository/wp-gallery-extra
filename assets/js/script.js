(function(b){function e(b){return wgextra[b]?wgextra[b]:b}function A(a,u){if(!a.hasClass("ui-initialized")||u){a.find('[rel="tabs"]').not(a.find('.ui-tabs-panel [rel="tabs"]')).tabs({activate:function(c,m){A(m.newPanel);m.newPanel.find("textarea.css, textarea.html, textarea.javascript, textarea.pug").each(function(){var c=b(this).data("editor");c&&c.refresh()})},create:function(b,m){m.panel.is(":visible")&&A(m.panel)}}).find(".ui-tabs-nav li a").on("click",function(){var c=O.scrollTop();location.hash=
b(this).attr("href");O.scrollTop(c)});a.find('button, input[type="button"], a.ui-button').not(a.find('.ui-tabs-panel button, .ui-tabs-panel input[type="button"], .ui-tabs-panel a.ui-button')).each(function(){var c=b(this),m=c.data().icon||"";c.button({icon:m})});var f=function(){var c=b(this),m=c.outerWidth();c.selectmenu({width:m||!1,open:function(b){b=v("#"+b.target.id+"-menu");var c=b.find(".ui-state-active"),m=b.outerHeight();b.scrollTop(c[0].offsetTop+c.outerHeight()/2-m/2)},change:function(c){b(c.target).trigger("change")}})},
d=a.find("select").not("[multiple], .in-controlgroup").not(a.find(".ui-tabs-panel select"));d.filter(":hidden").one("visible",f);d.filter(":visible").each(f);a.find("select[multiple]").not(a.find(".ui-tabs-panel select[multiple]")).multiSelect({selectableOptgroup:!0,selectableHeader:"<input type='text' class='search-input' autocomplete='off' placeholder='"+e("Type to Search...")+"'>",selectionHeader:"<input type='text' class='search-input' autocomplete='off' placeholder='"+e("Type to Search...")+
"'>",afterInit:function(b){var c=this;b=c.$selectableUl.prev();var a=c.$selectionUl.prev(),h="#"+c.$container.attr("id")+" .ms-elem-selectable:not(.ms-selected)",d="#"+c.$container.attr("id")+" .ms-elem-selection.ms-selected";c.qs1=b.quicksearch(h).on("keydown",function(b){if(40===b.which)return c.$selectableUl.focus(),!1});c.qs2=a.quicksearch(d).on("keydown",function(b){if(40==b.which)return c.$selectionUl.focus(),!1})},afterSelect:function(){this.qs1.cache();this.qs2.cache()},afterDeselect:function(){this.qs1.cache();
this.qs2.cache()}});a.find('input[type="radio"], input[type="checkbox"]').not(".onoffswitch-checkbox").not(a.find('.ui-tabs-panel input[type="radio"], .ui-tabs-panel input[type="checkbox"]')).checkboxradio({icon:!1});f=function(){b(this).controlgroup()};d=a.find(".switch-field, .controlgroup").not(a.find(".ui-tabs-panel .switch-field, .ui-tabs-panel .controlgroup"));d.filter(":hidden").one("visible",f);d.filter(":visible").each(f);a.find('input[rel="number"]').not(a.find('.ui-tabs-panel input[rel="number"]')).each(function(){var c=
b(this),m=c.data("options");m=m?eval("({"+m+"})"):{};var a=parseFloat(m.max)||null,h=parseFloat(m.min)||0;m=parseFloat(m.step)||1;c.spinner({min:h,max:a,step:m,stop:function(b,a){c.trigger("change")}})});a.find('input[rel="range"]').not(a.find('.ui-tabs-panel input[rel="range"]')).each(function(){var c=b(this),a=b("<div></div>"),q=c.data("options"),h=eval(c.val());q=q?eval("({"+q+"})"):{};var d=q.range||!1,f=parseFloat(q.max)||100,e=parseFloat(q.min)||0,u=parseFloat(q.step)||1,k=q.pips||!1,x=q.type||
"",p=q.forceTip||!1;a.insertAfter(c);c.hide();q["class"]&&a.addClass(q["class"]);p&&a.addClass("ui-slider-force-tip");"circle"===x?a.addClass("ui-circle-slider"):"scale"===x&&a.addClass("ui-scale-slider");q={range:d,min:e,max:f,step:u,slide:function(b,a){a.values?c.val(JSON.stringify(a.values)):c.val(a.value)},stop:function(b,a){c.trigger("change")}};q[b.isArray(h)?"values":"value"]=h;a.slider(q);k&&a.slider("pips",k).slider("float")});f=function(){var c=this,a=b(c),q=a.parents(".inside"),h=c.className;
if(a.is(".css, .html, .javascript, .twig")){var d={selectionPointer:!0,styleActiveLine:!0,lineNumbers:!0,matchBrackets:!0,matchTags:{bothTags:!0},indentUnit:4,indentWithTabs:!0,autoCloseBrackets:!0,autoCloseTags:!0,keyMap:"sublime",extraKeys:{"Ctrl-Space":"autocomplete","Ctrl-K":function(b,c){b.state.colorpicker.popup_color_picker()}},viewportMargin:Infinity,theme:"mdn-like"};-1!==h.indexOf("css")?(d.mode="text/x-less",d.colorpicker={mode:"edit"}):-1!==h.indexOf("javascript")?d.mode="text/javascript":
-1!==h.indexOf("twig")?(CodeMirror.defineMode("htmltwig",function(b,c){return CodeMirror.overlayMode(CodeMirror.getMode(b,c.backdrop||"text/html"),CodeMirror.getMode(b,"twig"))}),d.mode={name:"htmltwig",htmlMode:!0,alignCDATA:!0}):-1!==h.indexOf("html")&&(d.mode={name:"htmlmixed",alignCDATA:!0});var f=CodeMirror.fromTextArea(c,d);f.display.wrapper.style.maxWidth=q.width()-210+"px";a.data("editor",f);f.on("change",function(b,c){a.val(f.getValue()).trigger("input")});f.on("keyup",function(b,c){b.state.completionActive||
13==c.keyCode||b.showHint({completeSingle:!1})});a.on("update",function(){f.setValue(a.val());f.refresh()});O.on("resize",b.debounce(250,function(){f.display.wrapper.style.maxWidth=q.width()-210+"px"}))}else{var e=e||a.height(),u=parseInt(a.css("paddingBottom"))+parseInt(a.css("paddingTop"))||0;h=function(){a.height(e);a.height(c.scrollHeight-u)};a.on("input change keyup",h);h()}};d=a.find("textarea").not(a.find(".ui-tabs-panel textarea"));d.filter(":hidden").one("visible",f);d.filter(":visible").each(f);
a.find('[rel="colorpicker"]').not(a.find('.ui-tabs-panel [rel="colorpicker"]')).minicolors({control:"hue",format:"rgb",inline:!1,opacity:!0,theme:"bootstrap",changeDelay:300,change:function(c,a){b(this).trigger("change")}});a.find('[rel="datepicker"]').not(a.find('.ui-tabs-panel [rel="datepicker"]')).datepicker({changeMonth:!0,changeYear:!0});a.find('[rel="date_range"]').not(a.find('.ui-tabs-panel [rel="date_range"]')).each(function(){function c(c){try{var a=b.datepicker.parseDate("mm/dd/yy",c.value)}catch(r){a=
null}return a}var a=b(this),d=a.find('[rel="from_date"]').datepicker({defaultDate:"+1w",changeMonth:!0,changeYear:!0}).on("change",function(){f.datepicker("option","minDate",c(this))}),f=a.find('[rel="to_date"]').datepicker({defaultDate:"+1w",changeMonth:!0,changeYear:!0}).on("change",function(){d.datepicker("option","maxDate",c(this))})});a.find('[rel="image"]').not(a.find('.ui-tabs-panel [rel="image"]')).each(function(){var c=b(this),a=c.val()||"{}",d=JSON.parse(a),f=["ui-image-chooser"];c[0].hasAttribute("small")&&
f.push("small");var e=b("<div/>",{"class":f.join(" "),html:"<a></a><span></span>"});var u=e.find("span");a&&d.thumb&&(e.addClass("setted"),u.css("backgroundImage","url('"+d.thumb+"')"));c.after(e).detach().prependTo(e).prop({type:"hidden"}).addClass("initialized");c.on("change",function(){a=c.val()||"{}";d=JSON.parse(a);d.image?e.addClass("setted"):e.removeClass("setted");d.thumb||d.image?u.css("backgroundImage","url('"+(d.thumb||d.image)+"')"):u.css("backgroundImage","")});e.on("click","> span, > a",
function(){var a=b(this).parent(),f=this.tagName.toLowerCase();a.hasClass("setted")&&"span"!==f?a.hasClass("setted")&&"a"===f&&c.val("").trigger("change"):T(d.id,function(b){if(b){var a=b.sizes;c.val(JSON.stringify({image:a[a.large&&"large"||a.medium&&"medium"||a.thumbnail&&"thumbnail"||"full"].url,id:b.id,thumb:a.medium&&a.medium.url||a.thumbnail&&a.thumbnail.url||a.large&&a.large.url||a.full.url})).trigger("change")}})})});a.tooltip({position:{my:"center bottom-20",at:"center top",using:function(a,
d){b(this).css(a);b("<div>").addClass("arrow").addClass(d.vertical).addClass(d.horizontal).appendTo(this)}},content:function(){return b(this).prop("title")}});a.addClass("ui-initialized")}}function T(b,u){wp.media.frames.wgextra&&wp.media.frames.wgextra.dispose();wp.media.frames.wgextra=wp.media({title:e("Select an image"),multiple:!1,library:{type:"image"}});if(b)wp.media.frames.wgextra.on("open",function(){var a=wp.media.frames.wgextra.state().get("selection");wp.media.frames.wgextra.reset();try{var d=
wp.media.attachment(b);d.id&&a.add(d)}catch(c){}});wp.media.frames.wgextra.on("select",function(){u(wp.media.frames.wgextra.state().get("selection").first().toJSON());wp.media.frames.wgextra.dispose()});wp.media.frames.wgextra.open();wp.media.frames.wgextra.$el.find(".media-menu a").eq(1).hide()}function p(){window.$processing=b('<div class="processing"><div class="overlay"></div><div class="box"><span>Processing...</span><div class="progress"><div class="indeterminate"></div></div></div></div>');
$body.append(window.$processing)}function k(){window.$processing.remove()}function ba(a,e){var f=wgextra["template"===a?"templates_types":"sources_types"][e].fields.split(",");f=f.map(function(a){return'[rel="'+b.trim(a)+'"]'});return f.join(", ")}function U(a,e){var f={},d={"true":!0,"false":!1,"null":null};b.each(a.replace(/\+/g," ").split("&"),function(a,u){var c=u.split("="),h=decodeURIComponent(c[0]),m=f,k=0,r=h.split("]["),p=r.length-1;/\[/.test(r[0])&&/\]$/.test(r[p])?(r[p]=r[p].replace(/\]$/,
""),r=r.shift().split("[").concat(r),p=r.length-1):p=0;if(2===c.length)if(c=decodeURIComponent(c[1]),e&&(c=c&&!isNaN(c)?+c:"undefined"===c?void 0:void 0!==d[c]?d[c]:c),p)for(;k<=p;k++)h=""===r[k]?m.length:r[k],m=m[h]=k<p?m[h]||(r[k+1]&&isNaN(r[k+1])?{}:[]):c;else b.isArray(f[h])?f[h].push(c):f[h]=void 0!==f[h]?[f[h],c]:c;else h&&(f[h]=e?void 0:"")});return f}function D(b,e,f){var a=this;this._fncQueue="undefined"===typeof f?[]:f;this._delayCompleted=!1;this._$real=b;if("number"===typeof e&&0<=e&&
Infinity>e)this.timeoutKey=window.setTimeout(function(){a._performDummyQueueActions()},e);else if(null!==e&&"object"===typeof e&&"function"===typeof e.promise)e.then(function(){a._performDummyQueueActions()});else if("string"===typeof e)b.one(e,function(){a._performDummyQueueActions()});else return b}var O=b(window),V=b(document),v=function(b){var a={};return function(e,d){if(void 0===a[e]||d)a[e]=b(e);return a[e]}}(b);V.ready(function(){function a(a){var c=v("script#regenator_dialog").html();c=_.template(c)({totalItems:a.list.length});
var g=a.list.length,n=a.list.length;b(c).dialog({resizable:!0,height:"auto",maxHeight:400,width:790,modal:!0,closeOnEscape:!1,classes:{"ui-dialog":"wgextra-dialog"},open:function(c,t){function l(){if(!(0>=n)){var b=g-n;u(a.list[b],a.sizes,function(a){n--;k[0].value=(b+1)/g*100;200==a.status?(m.append("<li>"+a.message+"</li>"),H.text(parseInt(H.text())+1)):(m.append('<li class="failure">'+a.message+"</li>"),f.text(parseInt(f.text())+1));0===n&&h.append("<p>"+e("Finished.")+"</p>");h[0].scrollTop=h[0].scrollHeight;
0<n&&l()})}}var d=b(this),H=d.find("#total-successes em"),f=d.find("#total-failures em"),h=d.find(".dialog-bottom"),m=h.find("ol"),k=d.find("progress");l();b(window).on("resize.dialog scroll.dialog",b.debounce(50,function(){d.dialog("option","position",{my:"center",at:"center",of:window})}))},close:function(a,c){n=0;b(this).remove();b(window).off(".dialog")}})}function u(a,c,t){b.ajax({method:"POST",url:ajaxurl,data:{action:"wgextra",id:a,thumbnails:c,wgextra_task:"process_image_resize",wgextra_nonce:wgextra.nonce.process_image_resize}}).done(function(b){t(b)}).fail(function(b){t(!1)})}
function f(a,c,t,n){var g=v("script#prompt_dialog").html();g=_.template(g)({title:a,message:c,defaultValue:t||""});var l=0;b(g).dialog({classes:{"ui-dialog":"wgextra-dialog ui-corner-all ui-no-close"},width:500,resizable:!1,modal:!0,closeOnEscape:!1,buttons:[{text:wgextra.ok,"class":"primary",click:function(){var a=b(this),c=a.find('input[name="prompt"]').val();n(c);l=1;a.dialog("close")}},{text:wgextra.cancel,click:function(){b(this).dialog("close")}}],open:function(a,c){var g=b(this);b(window).on("resize.dialog scroll.dialog",
b.debounce(50,function(){g.dialog("option","position",{my:"center",at:"center",of:window})}));g.on("keydown.dialog",'input[name="prompt"]',function(b){13===b.keyCode&&g.parent().find("button.primary").click()})},close:function(a,c){b(this).off(".dialog").dialog("destroy").remove();b(window).off(".dialog");l||n(!1)}})}function d(a,c,t){var g=v("script#confirm_dialog").html();g=_.template(g)({title:a,message:c});var l=0;b(g).dialog({classes:{"ui-dialog":"wgextra-dialog ui-corner-all ui-no-close"},width:500,
resizable:!1,modal:!0,closeOnEscape:!1,buttons:[{text:wgextra.ok,"class":"primary",click:function(){t(!0);l=1;b(this).dialog("close")}},{text:wgextra.cancel,click:function(){b(this).dialog("close")}}],open:function(a,c){var g=b(this);b(window).on("resize.dialog scroll.dialog",b.debounce(50,function(){g.dialog("option","position",{my:"center",at:"center",of:window})}))},close:function(a,c){b(this).dialog("destroy").remove();b(window).off(".dialog");l||t(!1)}})}function c(a){var c=v("script#alert_dialog").html();
c=_.template(c)({message:a});b(c).dialog({classes:{"ui-dialog":"wgextra-dialog ui-corner-all ui-no-close"},width:500,resizable:!1,modal:!0,closeOnEscape:!1,buttons:[{text:wgextra.ok,click:function(){b(this).dialog("close")}}],open:function(a,c){var g=b(this);b(window).on("resize.dialog scroll.dialog",b.debounce(50,function(){g.dialog("option","position",{my:"center",at:"center",of:window})}))},close:function(a,c){b(this).dialog("destroy").remove();b(window).off(".dialog")}})}function m(a){b(this);
var g=h.find("table").first(),t=h.find("#empty_templates"),n=v("script#show_templates").html();n=_.template(n)({title:e("Import Template"),templates:a});b(n).dialog({draggable:!1,resizable:!1,height:window.innerHeight-100,width:window.innerWidth-130,modal:!0,closeOnEscape:!0,classes:{"ui-dialog":"wgextra-dialog"},open:function(a,n){var l=b(this),d=l.find("#importable-templates"),f=d.children(),H=l.find('input[type="search"]');A(l);b(window).on("resize.dialog scroll.dialog",b.debounce(50,function(){l.dialog("option",
"width",window.innerWidth-130);l.dialog("option","height",window.innerHeight-100);l.dialog("option","position",{my:"center",at:"center",of:window})}));d.isotope({transitionDuration:"0.65s",getSortData:{name:"[data-name]",date:"[data-date]"},sortBy:"date",sortAscending:!1});l.on("change.dialog","#template_type",function(){var b=this.value;d.isotope({filter:b});f=d.children().filter(b);H.val("")}).on("keyup.dialog",'input[type="search"]',b.debounce(400,function(){var a=new RegExp(H.val(),"gi");d.isotope({filter:function(){var c=
b(this);return-1===f.index(c)?!1:a?c.text().match(a):!0}})})).on("click.dialog",".template-action.import",function(){var a=this.getAttribute("rel");console.log(a);l.dialog("close");p();b.ajax({method:"POST",url:ajaxurl,data:{action:"wgextra",id:a,wgextra_task:"import_template",wgextra_nonce:wgextra.nonce.import_template}}).done(function(a){k();if(200==a.status){var l=v("script#new_template_row").html();l=_.template(l)(a);l=b(l);g.show().prepend(l);A(l);t.hide()}a.message&&c(a.message)}).fail(function(b){k();
c(e("Request failed, please try again."))})})},close:function(a,c){b(this).off(".dialog").dialog("destroy").remove();b(window).off(".dialog")}})}function q(a,c){var g=b.isArray(c.wgextra_post_types)?c.wgextra_post_types:[c.wgextra_post_types],l=wgextra.source_data.taxonomies,d="";b.each(g,function(a,c){wgextra.post_types_taxonomies[c]&&b.each(wgextra.post_types_taxonomies[c],function(a,c){if(0===c.terms.length)return!0;d+="<optgroup label='"+c.label+"'>";b.each(c.terms,function(b,c){var g=a+":"+c.slug,
n=-1!==l.indexOf(g)?" selected":"";d+="<option value='"+g+"'"+n+">"+c.name+" ("+c.count+" "+e("post(s)")+")</option>"});d+="</optgroup>"})});a.html(d);a.multiSelect("refresh")}$body=b(document.body);var h=V.find("#wgextra"),B=h.find("#wgextra_template_form").find("#wgextra-settings, #wgextra-display"),P=h.find("#wgextra_template_form #wgextra-styling"),r=h.find("#wgextra_template_form #wgextra-source");h.find("#wgextra_images_sizes_form");var D=h.find("#wgextra_settings_form"),w=B.find(".field"),
x=P.find(".field"),E=r.find(".field"),F=B.find("input, select, textarea"),G=P.find("input, select, textarea"),N=r.find("input, select, textarea"),ca=D.find("input, select, textarea"),Q=h.find("#sizes_to_rebuild"),T=h.find("#custom_gallery_structure"),R=h.find(".button_box"),W=h.find("form.warn-about-change").serializeJSON(!0),y=0,z=null;A(h);h.find(".box-title").sticky({topSpacing:v("#wpadminbar").height()});setTimeout(function(){y=300;z="blind"},1E3);var U=w.filter('[rel="tilt"]').find(".inside-table"),
Y=w.find("#magnific-popup-settings"),Z=w.find("#photoswipe-settings"),aa=w.find("#fancybox-settings"),fa=w.find("#ilightbox-settings"),ha=w.find("#custom_lightbox"),S=P.find("#slider-styles"),ia=w.filter('[rel="thumbnail_ratio"]').find(".inside-table"),ja=B.find('[rel="grouped_items_template"]'),ka=B.find(".wgextra_link_url");B.on("change","input, select",b.debounce(50,function(b){var a=this.name;b=F.serializeJSON(!0);"wgextra_template"===a&&(a=ba("template",b.wgextra_template),w.addClass("hidden").filter(a).removeClass("hidden"),
S["slider"===b.wgextra_template?"removeClass":"addClass"]("hidden"));w.filter('[rel="loading_grid_animation"]')["none"!==b.wgextra_loading_type?"removeClass":"addClass"]("hidden");w.filter('[rel="use_lowres_image"]')["lazyload"===b.wgextra_loading_type?"removeClass":"addClass"]("hidden");T["auto"===b.wgextra_structure_type?"hide":"show"](z,y);Y["magnific"!=b.wgextra_lightbox_type?"hide":"show"]();Z["photoswipe"!=b.wgextra_lightbox_type?"hide":"show"]();aa["fancybox"!=b.wgextra_lightbox_type?"hide":
"show"]();fa["ilightbox"!=b.wgextra_lightbox_type?"hide":"show"]();ha["custom"!=b.wgextra_lightbox_type?"hide":"show"](z,y);U["yes"===b.wgextra_tilt_effect?"show":"hide"](z,y);ka["custom"===b.wgextra_link_to?"removeClass":"addClass"]("hidden");w.filter('[rel="caption_custom"]')["custom"===b.wgextra_caption_source?"removeClass":"addClass"]("hidden");ia["manual"===b.wgextra_thumbnail_ratio?"show":"hide"](z,y);ja["slider"===b.wgextra_grouped_items_mode?"removeClass":"addClass"]("hidden")}));F.filter('[name="wgextra_template"]').trigger("change");
var la=x.filter('[rel="border"]').find(".inside-table"),ma=x.filter('[rel="shadow"]').find(".inside-table"),na=x.filter('[rel="placeholder"]').find(".inside-table"),oa=x.filter('[rel="icon"]').find(".inside-table"),pa=x.filter('[rel="overlay"]').find(".inside-table:eq(0)"),I=x.filter('[rel="overlay"]').find("#wgextra_style_overlay_background .inside-table"),qa=x.filter('[rel="caption"]').find(".inside-table:eq(0)"),J=x.filter('[rel="caption"]').find("#wgextra_style_caption_background .inside-table"),
K=S.find("#wgextra_style_slider_scrollbar_track_color .inside-table"),L=S.find("#wgextra_style_slider_scrollbar_handle_color .inside-table"),M=S.find("#wgextra_style_slider_time_loader_loader_color .inside-table");P.on("change","input, select",b.debounce(50,function(b,a){var c=this.name,g=G.serializeJSON(!0);"wgextra_style"==c?(c=JSON.parse(g.preset_styles),c[g.wgextra_style]&&c[g.wgextra_style].form_data&&G.setValues(c[g.wgextra_style].form_data)):a||(G.filter('[name="wgextra_style"][value="default"]').prop("checked",
!0),G.filter('[name="wgextra_style"]').checkboxradio("refresh",!0));la[g.wgextra_style_border?"show":"hide"](z,y);ma[g.wgextra_style_shadow?"show":"hide"](z,y);na[g.wgextra_style_use_placeholder?"show":"hide"](z,y);oa[g.wgextra_style_icon?"show":"hide"](z,y);pa[g.wgextra_style_overlay?"show":"hide"](z,y);"solid"===g.wgextra_style_overlay_background?(I.filter("#wgextra_style_overlay_background_solid").show(),I.filter("#wgextra_style_overlay_background_gradient").hide()):"gradient"===g.wgextra_style_overlay_background?
(I.filter("#wgextra_style_overlay_background_solid").hide(),I.filter("#wgextra_style_overlay_background_gradient").show()):I.hide();qa[g.wgextra_style_caption?"show":"hide"](z,y);"solid"===g.wgextra_style_caption_background?(J.filter("#wgextra_style_caption_background_solid").show(),J.filter("#wgextra_style_caption_background_gradient").hide()):"gradient"===g.wgextra_style_caption_background?(J.filter("#wgextra_style_caption_background_solid").hide(),J.filter("#wgextra_style_caption_background_gradient").show()):
J.hide();"solid"===g.wgextra_style_slider_scrollbar_track_color?(K.filter("#wgextra_style_slider_scrollbar_track_color_solid").show(),K.filter("#wgextra_style_slider_scrollbar_track_color_gradient").hide()):"gradient"===g.wgextra_style_slider_scrollbar_track_color?(K.filter("#wgextra_style_slider_scrollbar_track_color_solid").hide(),K.filter("#wgextra_style_slider_scrollbar_track_color_gradient").show()):K.hide();"solid"===g.wgextra_style_slider_scrollbar_handle_color?(L.filter("#wgextra_style_slider_scrollbar_handle_color_solid").show(),
L.filter("#wgextra_style_slider_scrollbar_handle_color_gradient").hide()):"gradient"===g.wgextra_style_slider_scrollbar_handle_color?(L.filter("#wgextra_style_slider_scrollbar_handle_color_solid").hide(),L.filter("#wgextra_style_slider_scrollbar_handle_color_gradient").show()):L.hide();"solid"===g.wgextra_style_slider_time_loader_loader_color?(M.filter("#wgextra_style_slider_time_loader_loader_color_solid").show(),M.filter("#wgextra_style_slider_time_loader_loader_color_gradient").hide()):"gradient"===
g.wgextra_style_slider_time_loader_loader_color?(M.filter("#wgextra_style_slider_time_loader_loader_color_solid").hide(),M.filter("#wgextra_style_slider_time_loader_loader_color_gradient").show()):M.hide();return!1}));G.filter('[name="wgextra_style"]:checked').trigger("change");var da=r.find("select#wgextra_post_types"),ea=r.find("select#wgextra_taxonomies"),ra=r.find(".wgextra_ordering_meta_key");r.on("change","input, select",b.debounce(50,function(b){var a=this.name,c=N.serializeJSON(!0);console.log(b);
"wgextra_source"===a?(a=ba("source",c.wgextra_source),E.addClass("hidden").filter(a).removeClass("hidden"),"woocommerce"===c.wgextra_source&&(da.multiSelect("deselect_all"),da.multiSelect("select",["product"])),b.isTrigger&&q(ea,c)):"wgextra_post_types"===a&&q(ea,c);ra[-1!==(c.wgextra_ordering_order_by||"").indexOf("meta_value")||-1!==(c.wgextra_ordering_order_by_fallback||"").indexOf("meta_value")?"removeClass":"addClass"]("hidden")}));N.filter('[name="wgextra_source"]:checked').trigger("change");
D.on("change","input, select",b.debounce(50,function(b){ca.serializeJSON(!0)}));ca.eq(0).trigger("change");B=h.find('button[type="submit"]').eq(0);var C=B[0]?Ladda.create(B[0]):null,X=!1;O.on("beforeunload",function(b){if(X){var a=e("It looks like you have been editing something. If you leave before saving, your changes will be lost.");return(b||window.event).returnValue=a}});V.find("#wgextra").on("change","form.warn-about-change",b.debounce(250,function(){var a=b(this).serializeJSON(!0),c=JSON.stringify(W)===
JSON.stringify(a);console.log(a,W);v("#wgextra-settings-notice")[c?"hide":"show"]();X=!c})).on("submit","form",function(){var c=b(this);c.find(".wgextra_ajax_message");var l=c.serializeJSON();delete l.preset_styles;console.log("submit",c);C&&C.start();l.action="wgextra";b.ajax({method:"POST",url:ajaxurl,data:l,xhr:function(){var a=b.ajaxSettings.xhr(),c=0;a.upload.addEventListener("progress",function(b){b.lengthComputable&&(c=b.loaded/b.total,C&&C.setProgress(c))},!1);return a}}).done(function(g){C&&
C.stop();var d="<strong>"+g.message+"</strong>";if(200===g.status)if((new Noty({text:d,type:"success",layout:"bottomCenter",theme:"mint",timeout:5E3,progressBar:!0,killer:!0})).show(),W=c.serializeJSON(!0),X=!1,v("#wgextra-settings-notice").hide(),"start_regenerator"===l.wgextra_task)a(g);else{if("save_images_sizes"===l.wgextra_task){var e="";b.each(l.image_size,function(b,a){a["delete"]||(e+=_.template('<option value="<%= size %>" selected="selected"><%= name %></option>')({size:b,name:a.name}))});
Q.html(e);Q.multiSelect("refresh");c.find('.self_created input[type="checkbox"].delete-switch:checked').each(function(){b(this).parents("tr").eq(1).remove()})}}else g.error&&(d+="<ul>"+g.error.join("")+"</ul>"),(new Noty({text:d,type:"error",layout:"bottomCenter",theme:"mint",timeout:5E3,progressBar:!0,killer:!0})).show()}).fail(function(b){C&&C.stop();(new Noty({text:e("Request failed, please try again."),type:"error",layout:"bottomCenter",theme:"mint",killer:!0})).show()});return!1}).on("click",
'button[type="submit"]',function(){h.find("form").eq(0).submit()}).on("click","#wgextra_new_template, #wgextra_new_source",function(){b(this);var a=this.id,d=h.find("table").first(),t=h.find("#empty_templates, #empty_sources"),n="wgextra_new_template"===a?"template":"source";f(e("template"===n?"Create a new template":"Create a new source"),e("template"===n?"Please enter your new template name.":"Please enter your new source name."),"",function(a){a&&(p(),b.ajax({method:"POST",url:ajaxurl,data:{action:"wgextra",
name:a,wgextra_task:"template"===n?"create_new_template":"create_new_source",wgextra_nonce:"template"===n?wgextra.nonce.create_new_template:wgextra.nonce.create_new_source}}).done(function(a){k();if(200===a.status){var g=b("template"===n?"script#new_template_row":"script#new_source_row").html();g=_.template(g)(a);a=b(g);d.show().prepend(a);A(a);t.hide()}else c(a.message)}).fail(function(b){k();c(e("Request failed, please try again."))}))})}).on("click","#wgextra_import_template",function(){p();b.ajax({method:"GET",
url:"https://wgextra.iprodev.com/templates/",data:{version:wgextra.version}}).done(function(b){k();200===b.status?(console.log(b),m(b.templates)):c(b.message)}).fail(function(b){k();c(e("Request failed, please try again."))})}).on("click",'[rel="duplicate_template"],[rel="duplicate_source"]',function(){var a=b(this),l=h.find("table").first(),t=a.attr("identifier"),n="duplicate_template"===this.rel?"template":"source";d(e("template"===n?"Duplicate Template":"Duplicate Source"),e("template"===n?"Are you sure you want to duplicate this gallery template?":
"Are you sure you want to duplicate this grid source?"),function(a){a&&(p(),b.ajax({method:"POST",url:ajaxurl,data:{action:"wgextra",id:t,wgextra_task:"template"===n?"duplicate_template":"duplicate_source",wgextra_nonce:"template"===n?wgextra.nonce.duplicate_template:wgextra.nonce.duplicate_source}}).done(function(a){k();if(200===a.status){var g=b("template"===n?"script#new_template_row":"script#new_source_row").html();g=_.template(g)(a);a=b(g);l.prepend(a);A(a)}else c(a.message)}).fail(function(b){k();
c(e("Request failed, please try again."))}))})}).on("click",'[rel="delete_template"],[rel="delete_source"]',function(){var a=b(this),l="delete_template"===this.rel?"template":"source",t=h.find("table"),n=h.find("template"===l?"#empty_templates":"#empty_sources"),f=a.parents("tr").last(),m=a.attr("identifier");d(e("template"===l?"Delete Template":"Delete Source"),e("template"===l?"Are you sure you want to delete this gallery template?":"Are you sure you want to delete this grid source?"),function(a){a&&
(p(),b.ajax({method:"POST",url:ajaxurl,data:{action:"wgextra",id:m,wgextra_task:"template"===l?"delete_template":"delete_source",wgextra_nonce:"template"===l?wgextra.nonce.delete_template:wgextra.nonce.delete_source}}).done(function(a){k();200===a.status?(1===f.parent().children("tr").length&&(t.hide(),n.show()),f.remove()):c(a.message)}).fail(function(a){k();c(e("Request failed, please try again."))}))})}).on("click",".add-css-selector",function(){var a=b(this),c=a.attr("rel");a=a.parents("td").find("textarea").data("editor");
var d=a.getValue(),e=b.extend({},a.getCursor()),f=a.lastLine();e.line=0===f?f+1:f+2;e.ch=2;"gallery"===c?d+="\n%gallery% {\n\t\n}":"item"===c?(d+="\n%gallery% {\n\t.wgextra-item {\n\t\t\n\t}\n}",e.line=0===f?f+2:f+3,e.ch=3):"thumb"===c?(d+="\n%gallery% {\n\t.wgextra-item {\n\t\t.wgextra-thumb {\n\t\t\t\n\t\t}\n\t}\n}",e.line=0===f?f+3:f+4,e.ch=4):"thumb-image"===c?(d+="\n%gallery% {\n\t.wgextra-item {\n\t\t.wgextra-thumb {\n\t\t\timg {\n\t\t\t\t\n\t\t\t}\n\t\t}\n\t}\n}",e.line=0===f?f+4:f+5,e.ch=
5):"thumb-overlay"===c?(d+="\n%gallery% {\n\t.wgextra-item {\n\t\t.wgextra-thumb {\n\t\t\t&:after {\n\t\t\t\t\n\t\t\t}\n\t\t}\n\t}\n}",e.line=0===f?f+4:f+5,e.ch=5):"inner-caption"===c?(d+="\n%gallery% {\n\t.wgextra-item {\n\t\t.wgextra-thumb {\n\t\t\t.wgextra-caption-inner {\n\t\t\t\t\n\t\t\t}\n\t\t}\n\t}\n}",e.line=0===f?f+4:f+5,e.ch=5):"outer-caption"===c?(d+="\n%gallery% {\n\t.wgextra-item {\n\t\tfigcaption.wp-caption-text {\n\t\t\t\n\t\t}\n\t}\n}",e.line=0===f?f+3:f+4,e.ch=4):"icon"===c&&(d+=
"\n%gallery% {\n\t.wgextra-item {\n\t\t.wgextra-thumb {\n\t\t\t.wgextra-icon:before {\n\t\t\t\t\n\t\t\t}\n\t\t}\n\t}\n}",e.line=0===f?f+4:f+5,e.ch=5);0===f&&(d=b.trim(d));a.setValue(d);a.setCursor(e);a.focus()}).on("click","#css-to-less",function(){var a=b(this).parents("td").find("textarea").data("editor"),f=a.getValue();d(e("Convert to LESS"),e("Are you sure you want to convert your CSS to LESS?"),function(d){d&&(p(),b.ajax({method:"POST",url:ajaxurl,data:{action:"wgextra",css:f,wgextra_task:"convert_to_less",
wgextra_nonce:wgextra.nonce.general}}).done(function(b){k();console.log(b);200===b.status?(a.setValue(b.less),a.setCursor({line:0,ch:0}),a.focus()):c(b.message)}).fail(function(a){k();c(e("Request failed, please try again."))}))})}).on("click","#add_new_image_size",function(){var a=b(this).parents("tr").eq(0);f(e("Register a new image size"),e("Please enter a valid ID for your new image size."),"",function(d){d&&(p(),b.ajax({method:"POST",url:ajaxurl,data:{action:"wgextra",id:d,wgextra_task:"verify_image_size_id",
wgextra_nonce:wgextra.nonce.verify_image_size_id}}).done(function(d){k();if(200===d.status){var e=v("script#new_image_size_row").html();e=_.template(e)(d);e=b(e);a.before(e);A(e);d=_.template('<option for="<%= size %>" selected="selected"><%= name %></option>')({size:d.id,name:d.id});Q.append(d);Q.multiSelect("refresh")}else c(d.message)}).fail(function(a){k();c(e("Request failed, please try again."))}))})}).on("click","#backup_thumbnails",function(){var a=b(this).parent();d(e("Backup Thumbnails"),
e("Are you sure you want to backup your current thumbnails?"),function(d){d&&(p(),b.ajax({method:"POST",url:ajaxurl,data:{action:"wgextra",wgextra_task:"backup_thumbnails",wgextra_nonce:wgextra.nonce.backup}}).done(function(b){k();200===b.status&&(a.find("#restore_backup, #delete_backup").removeAttr("disabled"),a.find("#last-backup em").text(b.time));b.message&&c(b.message)}).fail(function(a){k();c(e("Request failed, please try again."))}))})}).on("click","#restore_backup:not([disabled])",function(){d(e("Restore Backup"),
e("Are you sure you want to restore your last backup?"),function(a){a&&(p(),b.ajax({method:"POST",url:ajaxurl,data:{action:"wgextra",id:a,wgextra_task:"restore_backup",wgextra_nonce:wgextra.nonce.restore}}).done(function(a){k();a.message&&c(a.message)}).fail(function(a){k();c(e("Request failed, please try again."))}))})}).on("click","#delete_backup:not([disabled])",function(){var a=b(this).parent();d(e("Delete Backup"),e("Are you sure you want to delete your thumbnails backup?"),function(d){d&&(p(),
b.ajax({method:"POST",url:ajaxurl,data:{action:"wgextra",id:d,wgextra_task:"delete_backup",wgextra_nonce:wgextra.nonce.delete_backup}}).done(function(b){k();200===b.status&&(a.find("#restore_backup, #delete_backup").attr("disabled","disabled"),a.find("#last-backup em").text(e("Never")));b.message&&c(b.message)}).fail(function(a){k();c(e("Request failed, please try again."))}))})}).on("click","#analyze_thumbnails",function(){var a=b(this).parents("td.parent").eq(0),d=a.find("#analysis_results"),f=
a.find('[name="after_date"]').val(),h=a.find('[name="before_date"]').val();p();b.ajax({method:"POST",url:ajaxurl,data:{action:"wgextra",after_date:f,before_date:h,wgextra_task:"analyze_thumbnails",wgextra_nonce:wgextra.nonce.clean_thumbnails}}).done(function(b){k();200===b.status&&(a.find("#delete_thumbnails_holder, #analysis_results").show(),d.find("#original_files").text(b.original_files),d.find("#thumbnail_files").text(b.thumbnail_files),d.find("#total_file_size").text(b.total_file_size));b.message&&
c(b.message)}).fail(function(a){k();c(e("Request failed, please try again."))})}).on("click","#delete_thumbnails",function(){var a=b(this).parents("td.parent").eq(0),f=a.find("#analysis_results"),h=a.find('[name="after_date"]').val(),m=a.find('[name="before_date"]').val();d(e("Delete Thumbnails"),e("Are you sure you want to delete thumbnails?"),function(a){a&&(p(),b.ajax({method:"POST",url:ajaxurl,data:{action:"wgextra",after_date:h,before_date:m,wgextra_task:"clean_thumbnails",wgextra_nonce:wgextra.nonce.clean_thumbnails}}).done(function(a){k();
200===a.status&&(f.find("#original_files").text(a.original_files),f.find("#thumbnail_files").text(a.thumbnail_files),f.find("#total_file_size").text(a.total_file_size));a.message&&c(a.message)}).fail(function(a){k();c(e("Request failed, please try again."))}))})}).on("click","#activate_wgextra",function(){var a=Math.min(screen.availWidth,500),b=Math.min(screen.availHeight,screen.availHeight-100,885),c=screen.availHeight/2-b/2,d=screen.availWidth/2-a/2;window.open("https://verify.iprodev.com?item=wgextra&site="+
encodeURIComponent(wgextra.site_url)+"&redirect_uri="+encodeURIComponent(wgextra.activation_url),"license_activator","width="+a+",height="+b+",top="+c+",left="+d+",menubar=no,location=no,resizable=yes,scrollbars=yes,status=no")}).on("click","#deactivate_wgextra",function(){deactivate_product(wgextra.license_id,wgextra.license_nonce)}).on("click",".license-notify",function(){window.location.href=wgextra.activation_page}).on("click","#check_iprodev_contact",function(){var a=b(this),d=a.parent(),f=d.parent();
p();b.ajax({method:"POST",url:ajaxurl,data:{action:"wgextra",wgextra_task:"check_iprodev_server_contact",wgextra_nonce:wgextra.nonce.check_iprodev_server_contact}}).done(function(b){k();a.remove();200==b.status?(d.text(e("Yes")),f.find(".dashicons").addClass("dashicons-yes").parent().addClass("success")):(d.text(e("No")),f.find(".dashicons").addClass("dashicons-no-alt").parent().addClass("alert"))}).fail(function(){k();c(e("Request failed, please try again."))})});window.activate_product=function(a,
d){a&&d&&(p(),b.ajax({method:"POST",url:ajaxurl,data:{action:"wgextra",license_id:a,license_nonce:d,wgextra_task:"activate_license",wgextra_nonce:wgextra.nonce.activate_license}}).done(function(b){k();200==b.status&&(R.filter(".activation_box").hide(),R.filter(".deactivation_box").show(),wgextra.license_id=a,wgextra.license_nonce=d);b.message&&c(b.message)}).fail(function(a){k();c(e("Request failed, please try again."))}))};window.deactivate_product=function(a,d){a&&d&&(p(),b.ajax({method:"POST",
url:ajaxurl,data:{action:"wgextra",license_id:a,license_nonce:d,wgextra_task:"deactivate_license",wgextra_nonce:wgextra.nonce.deactivate_license}}).done(function(a){k();200==a.status&&(R.filter(".activation_box").show(),R.filter(".deactivation_box").hide(),wgextra.license_id="",wgextra.license_nonce="");a.message&&c(a.message)}).fail(function(a){k();c(e("Request failed, please try again."))}))};window.iprodev_alert=function(a){a&&(b.isArray(a)||(a=[a]),a=e(a[0]),c(a))}});var N=/\r?\n/g,Y=/^(?:submit|button|image|reset|file)$/i,
Z=/^(?:input|select|textarea|keygen)/i,aa=/^(?:checkbox|radio)$/i;b.fn.serializeJSON=function(a,e){var f=this.map(function(){var a=b.prop(this,"elements");return a?b.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!b(this).is(":disabled")&&Z.test(this.nodeName)&&!Y.test(a)&&(this.checked||!aa.test(a))}).map(function(d,c){var f=b(this).val(),k=c.name;return null==f||a&&!f||e&&e[k]===f?null:b.isArray(f)?b.map(f,function(a){return{name:k,value:a.replace(N,"\r\n")}}):{name:k,value:f.replace(N,
"\r\n")}}).get();return U(b.param(f))};D.prototype._addToQueue=function(a,b){this._fncQueue.unshift({fnc:a,arg:b});return this._delayCompleted?this._performDummyQueueActions():this};D.prototype._performDummyQueueActions=function(){this._delayCompleted=!0;for(var a;0<this._fncQueue.length;){a=this._fncQueue.pop();if("wait"===a.fnc)return a.arg.push(this._fncQueue),this._$real=this._$real[a.fnc].apply(this._$real,a.arg);this._$real=this._$real[a.fnc].apply(this._$real,a.arg)}return this};b.fn.wait=
function(a,b){return new D(this,a,b)};for(var E in b.fn)"function"===typeof b.fn[E]&&b.fn.hasOwnProperty(E)&&(D.prototype[E]=function(a){return function(){var b=Array.prototype.slice.call(arguments);return this._addToQueue(a,b)}}(E));var F;b.throttle=F=function(a,e,f,d){function c(){function b(){p=+new Date;f.apply(m,q)}function c(){k=void 0}var m=this,r=+new Date-p,q=arguments;d&&!k&&b();k&&clearTimeout(k);void 0===d&&r>a?b():!0!==e&&(k=setTimeout(d?c:b,void 0===d?a-r:a))}var k,p=0;"boolean"!==typeof e&&
(d=f,f=e,e=void 0);b.guid&&(c.guid=f.guid=f.guid||b.guid++);return c};b.debounce=function(a,b,e){return void 0===e?F(a,b,!1):F(a,e,!1!==b)};b.fn.setValues=function(a){var e=this;if(b.isPlainObject(a))return b.each(a,function(a,b){var c=e.filter('[name="'+a+'"]');if(c[0]){var d=(c[0].type||c[0].tagName).toLowerCase().replace("select-one","select");if("radio"===d)c.filter('[value="'+b+'"]').prop("checked",!0).trigger("change",[!0]),c.hasClass("ui-checkboxradio")&&c.checkboxradio("refresh");else if("checkbox"===
d)c.prop("checked",!!b).trigger("change",[!0]);else if("select"===d){c.val(b).trigger("change",[!0]);try{c.selectmenu("refresh")}catch(q){}}else c.val()!==b&&(c.val(b).trigger("change",[!0]),c.hasClass("minicolors-input")&&c.minicolors("value",{color:b}))}}),this}})(jQuery);